## 12장. 상속을 통한 재사용
### 12.1 상속이란?
- 상속 -> 어떤 클래스에서 선언된 것은 그것을 세분화한 '자식 클래스'에게도 자동으로 이어지는 방식.

#### 상속에 관한 다양한 접근법
- 일반화/특수화
  - 자식 클래스는 부모 클래스의 일종입니까? (O)
- 공통 부분을 추출
  - 복수 클래스의 공통 부분을 부모 클래스로서 추출하면 좋다.
  - 자식 클래스는 부모 클래스의 일종입니까? (X)
- 차분 구현
  - 상속 후 변경된 부분만을 구현하면 효율이 좋다.
  - 자식 클래스는 부모 클래스의 일종입니까? (X)

#### 상속은 양날의 칼
- 상속을 반복하면 상속 관계를 따라가면서 수많은 코드를 확인해야한다.
- 따라서 상속 트리의 깊이를 낮춰야 한다.

#### 리스코프의 치환 원칙
- T형의 객체 x에 관해 어떤 속성 q(x)가 항상 참이라고 한다.
- S가 T의 파생형이면, S형의 객체 y의 속성 q(y)가 항상 참이어야 한다.
- 어떤 클래스 T의 객체에 대해 항상 성립하는 조건이 았다면, 그 조건은 자식 클래스 S의 객체에서도 항상 성립해야한다는 뜻이다.
- 상속은 'is-a' 관계여야한다는 엄격한 제약이 있다.


### 12.2 다중 상속
#### 하나의 사물을 복수로 분류
- 현실 세계에서 하나의 사물이 복수의 분류에 해당하는 경우가 있기 때문에 그것을 모델화하는 프로그래밍 언어가 복수의 클래스를 상속할 수 있어야한다.
- 이것이 다중 상속이다.

#### 코드 재사용에 편리한 다중 상속
- class 메뉴 바가 있는 윈도우와 class 스크롤 바가 있는 윈도우 2개를 동시에 상속받으면 class 메뉴 바와 스크롤 바가 있는 윈도우가 된다.

### 12.3 다중 상속의 문제점
- 다중 상속받은 클래스에게 'x의 값은 무엇인가?'라고 물으면 어떻게 될까?
- 해당 클래스가 x값을 알고 있으면 대답이 가능하지만, 모른다면 부모 클래스에게 물어본다.
- 이때 두 부모가 동일한 x를 가지고 있다면 충돌이 발생한다.

#### 해결책 1 : 다중 상속을 금지한다
- Java는 클래스 다중 상속을 금지한다.
- 대신 위임을 사용한다. 위임은 사용하고 싶은 코드를 가지고 있는 클래스 객체를 만들고, 필요에 따라 해당 클래스에 처리를 맡기는 방법이다.
```java
public class TestDelegate {
  public static void main(String[] args) {
      new UseInheritance().useHello(); // Hello!
      new UseDelegate().useHello(); // Hello!
  }
}

class Hello {
  public void hello() {
    System.out.println("Hello!")
  }
}

class UseInheritance extends Hello {
  public void useHello() {
    hello();
  }
}

class UseDelegate {
  Hello h = new Hello();
  public void useHello() {
    h.hello();
  }
}
```

#### 인터페이스
- Java의 인터페이스는 다중 상속을 허용한다.
- 인터페이스는 코드를 가지고 있지 않는 클래스다.
- 인터페이스의 다중 상속으로 가지고 있다는 정보가 복수 개 있다고 해도, 그것은 가지고 있다는 사실 자체이기때문에 아무 문제도 발생하지 않는다.

#### 해결책 2 : 메소드 해결 순서를 고민한다
- 단순히 자신이 모른다면 왼쪽 부모부터 순서대로 확인한다는 깊이 우선 탐색은 어떨까?
- 마름모 계승 문제
  - Base 클래스가 x = "A"를 갖고, Derived1과 Derived2가 Base를 상속받는다고 하자.
  - Derived1은 x가 없고, Derived2는 x = "B"이다.
  - 이때, Multi는 Derived1과 Derived2를 상속받되, x가 없다.
  - 이 상황에서 Multi에게 x를 물어보면 x는 왼쪽 부모부터 차례대로 검사하므로 "A"를 출력할 것이다.
- C3 선형화로 순서를 정한다.
  - 부모 클래스는 자식 클래스보다 먼저 탐색되지 않는다.
  - 어떤 클래스가 복수의 부모 클래스를 상속하고 있으면 먼저 만들어진 것이 우선된다.
  - 위 예시에서 Multi에게 x를 물어보면 "B"를 출력한다.

#### 해결책 3 : 처리를 섞는다
- 재사용하고 싶은 기능만을 모은 작은 클래스를 만들어서 해당 기능을 추가하고 싶은 클래스에 섞어 넣는다.
- 믹스 인(Mix-in)이라고 부른다.

#### 해결책 4 : 트레이트
- 클래스의 역할
  - 인스턴스를 만들기 위한 것.
  - 재사용 단위.
- 클래스가 인스턴스를 만들기 위한 것으로 사용될 때는 재사용 단위로 너무 크다.
- 따라서 재사용 단위라는 역할에 특화된 보다 작은 구조(트레이트 = 메소드 묶음)을 만드는 것이 좋다.
