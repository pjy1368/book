## 8장. 형
### 8.1 형이란?
- 형은 사람이 데이터에 붙인 '추가 데이터'이다.

### 8.2 수치를 On과 Off로 표현하는 방법
- 수치를 램프의 점등과 점멸로 어떻게 표현할까? -> n을 표현하기 위해서 n개의 램프를 켠다.

#### 자릿수 발명
- 999라는 수를 표현하기 위해 999개의 램프를 이용하는 것은 비효율적이다.
- 따라서 백의 자리, 십의 자리, 일의 자리에 따라 램프를 사용한다.
- 0 ~ 999까지 100의 자리 9개, 10의 자리 9개, 1의 자리 9개의 전체 27개 램프만 있으면 된다.

#### 세그먼트 디스플레이
- 7 세그먼트 디스플레이를 사용하면 7개의 램프로 한 자릿수를 표현할 수 있다.

#### 주판
- 4개의 구슬로 0 ~ 4를 표현하고, 다른 하나의 구슬로 그것에 5를 더할지를 표현한다.
- 5개의 램프로 한 자릿수를 표현할 수 있다.

### 8.3 한 자리에 필요한 램프는 몇 개일까?
- n개의 램프로는 2<sup>n</sup>가지 부호를 표현할 수 있다.

#### 10진수에서 2진수로
- 2진수를 이용하면 10개의 램프로 0부터 1023까지 표현할 수 있다.

#### 8진수와 16진수
- 2진수 문자 몇 개를 모아서 한 개의 문자로 표현함으로써 사람도 읽기 쉽게 표현한 것이 8진수와 16진수이다.
- 8진수는 2진수 문자를 3개씩 묶고, 16진수는 2진수 문자를 4개씩 묶는다.

### 8.4 실수는 어떻게 표현할까?
#### 고정 소수점
- 소수점을 어디에 붙일지 정한다.
- 어디까지 소수부로 정했는지 사람이 잊어버릴 수 있다.

#### 부동 소수점
- 어디부터 소수부인지의 정보 자체를 값에 포함시킨다.
- 16개 램프로 소수를 표현한다면, 16개 중 10개의 램프로 0 ~ 1023까지 수를 표현할 수 있으므로 유효 숫자 3자리 정보를 표현할 수 있다.
- 나머지 6개 램프로 0 ~ 63까지 표현할 수 있으므로 이것을 소수점 위치 표현에 사용한다.
- IEEE 754가 정의하고 있는 부동 소수점 구조
  - 지수부와 가수부
  - 최상위 비트가 0이면 +, 1이면 -
- 대부분의 언어에서 IEEE 754를 채택하지만, 무한 소수의 경우 문제가 생길 수 있어서 은행같은 분야에서는 고정소수점수나 Excess-3 방식을 채택한다.

### 8.5 형은 무엇을 위해 존재할까?
#### 형이 없을 때 발생하는 문제
- 부동 소수점 3.0 + 7.0 = 10.0 이 된다.
- 하지만, 메모리에 이것이 부동 소수점이라는 것을 잊어버리고 정수로 덧셈하라고 하면 매우 큰 정수값이 된다.
- 이것은 부동 소수점과 정수의 비트 패턴이 완전 다르기 때문이다.

#### 초기 FORTRAN의 형
- 변수명 선두가 1 ~ N이면 정수, 그 이외이면 부동 소수점이 들어있다는 규칙을 사용하였다.

#### 언어 처리계에 변수 종류를 알린다.
- C언어 -> int x; float y; ...

#### 암묵의 형 승격
- 정수끼리, 부동 소수점끼리 연산한다.
- 한 쪽이 정수고 다른 한쪽이 부동 소수점인 경우
  - FORTRAN은 에러 처리.
  - C언어는 정수를 부동 소수점으로 암묵적 변환시킴.
  
#### 문제점
- x / 2 를 생각해 보자.
- x가 1이라면, 계산 결과가 0이 된다.
- 따라서 프로그래머가 x의 형을 기억해야한다는 문제가 있다.

#### 코드 작성법으로 구별하는 언어
- ML 언어 -> x div y : 정수 나눗셈, x / y : 부동 소수점 나눗셈
- Python -> 소수점 이하를 버리지 않는 나눗셈과 버리는 나눗셈 두 개가 존재함.

### 8.6 형의 다양한 전개
#### 사용자 정의형과 객체 지향
- 언어가 가지고 있는 기본적인 형을 조합해서 새로운 형을 만드는 기능이 발명되었다. ex) C언어의 구조체
- 데이터 뿐만 아니라 함수 등 데이터를 처리하는 기능도 형으로 정리되었다. ex) C++의 클래스

#### 사양으로서 형
- 형은 사양이다.
  - 구조체나 클래스를 구성하는 형을 전부하지 않고 최소한만을 공개한다.
  - 자연스럽게 public 이나 private 같은 접근 권한이 생기게 됨.
- 인터페이스가 등장하였다.
  - 인터페이스는 구처젝인 구현 방법을 갖고 있지 않은 형이다.
- 형으로 모든 사양을 표현할 수는 없다.

#### 총칭형, 제네릭스, 템플릿
- 다양한 형을 조합해서 만든 복잡한 형이 사용되면서 재사용성의 필요가 생겨났다.
- 총칭형 -> 구성 요소의 형을 일부만 바꾸는 형. ex) C++의 템플릿, Java의 제네릭, Haskell의 형 생성자

#### 동적 형결정
- 동적 형결정 : 변수명, 값이 저장된 메모리 위치와 같은 종류 정보를 값과 함께 세트로 가지고 있는 것.
- python은 같은 변수에 정수와 부동 소수점을 모두 넣을 수 있다.
- Python에서 값은 PyObject형으로 취급된다.
- 정적 형은 컴파일 단계에서 에러를 찾을 수 있지만, 동적 형은 그렇지 않다.

#### 형 추론
- 컴파일 시에 형 체크는 하지만, 형 선언은 하지 않는 것이다.

#### 강한 형으로 버그 없는 프로그램을 만들 수 있는가?
- 버그를 만들어내지 않는 방법에 몰두하기 보다는 버그를 빨리 발견해서 죽이는 연구를 하는 편이 낫다.
