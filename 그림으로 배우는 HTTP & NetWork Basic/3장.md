# 제3장. HTTP 정보는 HTTP 메시지에 있다
## 3.1 HTTP 메시지
- HTTP에서 교환하는 정보를 HTTP 메시지라고 부르는데, 메시지 헤더와 메시지 바디로 구성된다.

## 3.2 리퀘스트 메시지와 리스폰스 메시지의 구조
### 리퀘스트 라인
- 리퀘스트에 사용하는 메소드와 리퀘스트 URI와 사용하는 HTTP 버전이 포함된다.

### 상태 라인
- 리스폰스 결과를 나타내는 상태 코드와 설명, 사용하는 HTTP 버전이 포함된다.

### 헤더 필드
- 리퀘스트와 리스폰스의 여러 조건과 속성 등을 나타내는 각종 헤더 필드가 포함된다.

### 그 외
- HTTP의 RFC에는 없는 헤더 필드(쿠키 등)가 포함되는 경우가 있다.

## 3.3 인코딩으로 전송 효율을 높이다
### 3.3.1 메시지 바디와 엔티티 바디의 차이
- 메시지: HTTP 통신의 기본 단위로 옥텟 시퀀스로 구성되고 통신을 통해서 전송된다.
- 엔티티: 리퀘스트랑 리스폰스의 페이로드로 전송되는 정보로 엔티티 헤더 필드와 엔티티 바디로 구성된다.
- HTTP 메시지 바디의 역할은 리퀘스트랑 리스폰스에 관한 엔티티 바디를 운반하는 일이다.
- 기본적으로 메시지 바디와 엔티티 바디는 같으나, 전송 코딩이 적용된 경우 엔티티 바디의 내용이 바뀌어서 메시지 바디와 달라진다.

### 3.3.2 압축해서 보내는 콘텐츠 코딩
- 콘텐츠 코딩은 엔티티에 적용하는 인코딩을 가리키는데 엔티티 정보를 유지한 채로 압축한다.
- 콘텐츠 코딩된 엔티티는 수신한 클라이언트 측에서 디코딩한다.
- ex) gzip, compress, deflate, identity

### 3.3.3 분해해서 보내는 청크 전송 코딩
- HTTP 통신에서 엔티티 바디의 전송이 완료되지 않으면 브라우저에 표시되지 않는다.
- 사이즈가 큰 데이터를 전송하는 경우에 데이터를 분할해서 조금씩 표시할 수 있다.
- 위와 같이 엔티티 바디를 분할하는 기능을 청크 전송 코딩이라고 한다.

## 3.4 여러 데이터를 보내는 멀티 파트
- 메일은 메일의 본문이나 복수의 첨부 파일을 붙여서 함께 보낼 수 있다.
- 이것은 MIME(다목적 인터넷 메일 확장 사양) 덕분이다.
- MIME는 이미지 등의 바이너리 데이터를 아스키 문자열에 인코딩하는 방법과 데이터의 종류를 나타내는 방법 등을 규정하고 있다.
- HTTP도 멀티파트에 대응하고 있어 하나의 메시지 바디 내부에 엔티티를 여러 개 포함시켜 보낼 수 있다.
- 멀티 파트의 종류
  - mulitpart/form-data: Web 폼으로부터 파일 업로드에 사용된다.
  - multipart/byteranges: 상태 코드 206 리스폰스 메시지가 복수 범위의 내용을 포함하는 때에 사용된다.
- HTTP 메시지로 멀티파트를 사용할 때에는 Content-type 헤더 필드를 사용한다.

## 3.5 일부분만 받는 레인지 리퀘스트
- 다운로드 중에 커넥션이 끊어져도 다운로드를 이어서 하기 위하여 리줌이라는 기능이 필요해졌다.
- 이 기능을 실현하려면 엔티티의 범위를 지정해서 다운로드 해야 한다.
- 이와 같이 범위를 지정하여 리퀘스트하는 것을 레인지 리퀘스트라고 부른다.
- Range 헤더 필드를 사용한다.
- 레인지 리퀘스트에 대한 리스폰스는 상태 코드 206 Partial Content라는 리스폰스 메시지가 되돌아 온다.

## 3.6 최적의 콘텐츠를 돌려주는 콘텐츠 네고시에이션
- 콘텐츠 네고시에이션: 클라이언트와 서버가 제공하는 리소스의 내용에 대해서 교섭하는 것이다.
- 클라이언트에 더욱 적합한 리소스를 제공하기 위한 구조이다.

### 서버 구동형 네고시에이션
- 서버 측에서 콘텐츠 네고시에이션을 하는 방식이다.
- 서버 측에서 리퀘스트 헤더 필드의 정보를 참고해서 자동으로 처리한다.

### 에이전트 구동형 네고시에이션
- 클라이언트 측에서 콘텐츠 네고시에이션을 하는 방식이다.
- 브라우저에 표시된 선택지 중에서 유저가 수동으로 선택한다.

### 트랜스페어런트 네고시에이션
- 서버 구동형 + 에이전트 구동형
