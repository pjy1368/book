### 04 역할, 책임, 협력
-  가정 : 인간은 이기적인 동시에 합리적인 존재이다.
- 최후통첩 게임 실험
  - 가정에 의하면, 제안자는 응답자가 최소한의 돈만 갖도록 제안할 것임.
  - 실제로, 제안자는 40% 이상의 금액을 응답자에게 제안하였고, 응답자는 20% 이하의 금액은 대부분 거절하였다.
  - 즉, 개인이 처해있는 정황 또는 문맥이 인간의 행동 방식을 결정한다.
  - 여기서, 인간의 행동을 결정하는 문맥은 타인과의 협력이다.
- 개별적인 객체의 행동이나 상태가 아니라, 객체들 간의 협력에 집중하라!

### 협력
#### 요청하고 응답하며 협력하는 사람들
- 협력은 한 사람이 다른 사람에게 도움을 요청할 때 시작된다.

#### 누가 파이를 훔쳤지?
- 이상한 나라의 앨리스 줄거리
  - 앨리스는 재판장에 왔는데, 판사는 하트왕이었고, 주변 인물로는 피고 하트 잭, 증인 모자 장수, 하얀 토끼가 있음.
  - 왕과 모자 장수, 토끼는 하트 잭을 재판하기 위해 협력하고 있음.

#### 재판 속의 협력
- 누군가 왕에게 재판을 요청하면서 재판이 시작.
- 왕이 하얀 토끼에게 증인을 부를 것을 요청.
- 토끼는 모자 장수에게 증인석으로 입장할 것을 요청.
- 모자 장수는 토끼의 요청에 응답.
- 모자 장수의 입장은 왕이 토끼에게 요청했던 증인 호출의 응답이기도 함.
- 왕은 모자 장수에게 증언할 것을 요청.
- 모자 장수는 증언함으로써 응답.

### 책임
- 객체가 어떤 요청에 대해 대답해 줄 수 있거나, 적절한 행동을 할 의무가 있는 경우 해당 객체가 책임을 가진다고 말한다.

#### 책임의 분류
- 객체의 책임 -> 하는 것(doing) + 아는 것(knowing)
- 다시 말해서, 책임은 객체의 외부에 제공해 줄 수 있는 정보와 외부에 제공해줄 수 있는 서비스의 목록이다.

#### 책임과 메시지
- 메시지 전송 : 객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것. (송신자 <-> 수신자)
- 책임 vs 메시지
  - 책임은 협력이라는 문맥 속에서 요청을 수신하는 한 쪽의 객체 관점에서 무엇을 할 수 있는지를 나열하는 것.
  - 메시지는 협력에 참여하는 두 객체 사이의 관계를 강조하는 것.

### 역할
#### 책임의 집합이 의미하는 것
- 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행하는 역할을 암시한다.

#### 판사와 증인
- 이상한 나라의 앨리스 줄거리
  - 이전까지 증인을 모자 장수로 하였지만, 이번에는 요리사다.
  - 하지만, 산쥐때문에 법정이 혼란스러워졌고, 요리사는 사라졌다.
  - 대신 다음 증인으로는 앨리스가 불렸다.
  - 다만, 왕은 판사를 여왕하게 위임하였다.
- 재판 과정은 전부 같으나, 앨리스 심판때는 판사가 왕에서 여왕으로 바뀐 것을 알 수 있다.
- 하지만, 3가지 재판 과정은 전부 같기때문에 따로 따로 관리할 필요가 없다.

#### 역할이 답이다
- 왕과 여왕은 '판사', 모자 장수와 요리사, 앨리스는 '증인'으로 추상화할 수 있다.
- 역할은 객체지향 설계의 단순성, 유연성, 재사용성을 뒷받침하는 핵심 개념이다.

#### 협력의 추상화
- 역할은 협력을 추상화할 수 있다.

#### 대체 가능성
- 객체는 역할에 주어진 책임 이외에 다른 책임을 수행할 수도 있다.
- 역할의 대체 가능성은 행위 호환성을 의미하고, 행위 호환성은 동일한 책임의 수행을 의미한다.

### 객체의 모양을 결정하는 협력
#### 흔한 오류
- 객체는 시스템에 필요한 데이터를 저장하기위해 존재한다?
  - 데이터는 단지 객체가 행위를 수행하는 데 필요한 재료에 불과하다.
  - 객체가 존재하는 이유는 행위를 수행하며 협력에 참여하기 위해서다.
- 객체지향이 클래스와 클래스 간의 관계를 표현하는 시스템의 정적인 측면에 중점을 둔다?
  - 중요한 것은 협력에 참여하는 동적인 객체
  - 클래스는 객체를 표현하고 생성하기 위한 도구일 뿐.
- 이러한 오류가 생긴 이유 -> 협력이라는 문맥을 고려하지 않고 각 객체를 독립적으로 바라보기 때문이다.

#### 협력을 따라 흐르는 객체의 책임
- 협력을 구성하는 데 필요한 책임 고안 -> 필요한 객체 선택 -> 행동 정의 -> 데이터 정의 -> 클래스 개발

### 객체지향 설계 기법
- 책임-주도 설계 : 협력에 필요한 책임들을 식별하고 적합한 객체에게 책임을 할당하는 방식으로 애플리케이션을 설계하는 기법.
- 디자인 패턴 : 전문가들이 반복적으로 사용하는 해결 방법을 정의해 놓은 설계 템플릿의 모음.
- 테스트 주도 개발 : 테스트를 먼저 작성하고 테스트를 통과하는 구체적인 코드를 추가하면서 애플리케이션을 완성해나가는 방식.

#### 책임-주도 설계
- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 챙미으로 분할한다.
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
- 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.

#### 디자인 패턴
- 책임-주도 설계의 결과를 표현한다.
- 디자인 패턴은 반복적으로 발생하는 문제와 그 문제에 대한 해법의 쌍으로 정의된다.
- 패턴은 반복해서 일어나는 특정한 상황에서 어떤 설계가 왜(why) 더 효과적인지에 대한 이유를 설명한다.
- 디자인 패턴은 공통으로 사용할 수 있는 역할, 책임, 협력의 템플릿이다.

#### 테스트-주도 개발
- 테스트-주도 개발은 객체가 이미 존재한다고 가정하고 객체에게 어떤 메시지를 전송할 것인지에 관해 생각하는 것이 좋다.
- 테스트-주도 개발은 테스트를 작성하는 것이 아니라 책임을 수행할 객체 또는 클라이언트가 기대하는 객체의 역할이 메시지를 수신할 때 어떤 결과를 반환하고 그 과정에서 어떤 객체와 협력할 것인지에 대한 기대를 코드의 형태로 작성하는 것이다.
