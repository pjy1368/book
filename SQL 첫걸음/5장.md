# 5장. 집계와 서브쿼리
## 20강. 행 개수 구하기 - COUNT
### 1. COUNT로 행 개수 구하기
- 'COUNT (집합)'
- 인수로 주어진 집합의 개수를 구해 반환한다.

### 2. 집계함수와 NULL값
- COUNT의 인수로 열명을 지정할 수 있다.
- 집합 안에 NULL 값이 있을 경우 무시한다.

### 3. DISTINCT로 중복 제거
- ex) SELECT DISTINCT name FROM sample51;
- name 열에 있는 동일한 행을 중복 제거한다.

### 4. 집계함수에서 DISTINCT
- 중복하지 않는 데이터의 개수를 어떻게 구할까?
- COUNT, DISTINCT, WHERE 구의 조건을 지정해서 구할 수는 없다.
- 왜냐하면, WHERE 구에서는 검색할 조건을 지정할 수 밖에 없고 중복된 값인지 아닌지를 알아보는 함수도 없기 때문이다.
- 또한, SELECT DISTINCT COUNT(name) 과 같은 명령도 먼저 중복을 제거해 버리므로 항상 1이 나온다.
- 정답은 집계함수의 인수로 DISTINCT를 사용하는 것이다. ex) COUNT(DISTINCT name)

## 21강. COUNT 이외의 집계함수
### 1. SUM으로 합계 구하기
- NULL 무시

### 2. AVG로 평균 내기
- NULL 무시
- 만약 NULL을 0으로 하고싶다면, CASE를 통해 NULL을 0으로 변환한 다음 AVG로 쓰면 된다.

### 3. MIN, MAX로 최솟값, 최댓값 구하기
- NULL 무시

## 22강. GROUP BY
- GROUP BY 구를 사용해 집계함수로 넘겨줄 집합을 그룹으로 나눌 수 있다.

### 1. GROUP BY로 그룹화
- 지정된 열의 값이 같은 행이 하나의 그룹으로 묶인다. (중복이 제거된다는 뜻.)
- DISTINCT vs GROUP BY
  - GROUP BY 구를 지정하는 경우에는 집계함수와 함께 사용하지 않으면 의미가 없다.
- ex) SELECT name, COUNT(name), SUM(quantity) FROM sample51 GROUP BY name;

### 2. Having 구로 조건 지정
- 집계함수는 WHERE 구의 조건식에서는 사용할 수 없다.
- HAVING 구는 GROUP BY 구의 뒤에 기술하며 WHERE 구와 동일하게 조건식을 지정할 수 있다.
- 내부 처리 순서
  - WHERE - GROUP BY -> HAVING -> SELECT -> ORDER BY
- SELECT에서 정해준 별명은 ORDER BY에서만 사용이 가능하다.

### 3. 복수열의 그룹화
- GROUP BY에 지정한 열 이외의 열은 집계함수를 사용하지 않은 채 SELECT 구에 기술하면 안 된다.
- ex) SELECT no, name, quantity FROM sample51 GROUP BY name; (x)
- ex) SELECT MIN(no), name, SUM(quantity) FROM sample51 GROUP BY name; (o)

### 4. 결괏값 정렬
- ORDER BY 구를 사용한다.

## 23강. 서브쿼리
- (특정 명령)

### 1. DELETE의 WHERE 구에서 서브쿼리 사용하기
- ex) DELETE FROM sample54 WHERE a = (SELECT MIN(a) FROM sample54);
- 다만, 위 코드에서는 "You can't specify target table 'sample54' for update in FROM clause'라는 에러가 발생한다.
- 그 이유는 데이터를 추가하거나 갱신할 경우 동일한 테이블을 서브쿼리에서 사용할 수 없도록 막아 놓았기 때문이다.
- 따라서 아래와 같이 코드를 고쳐야 한다.
- DELETE FROM sample54 WHERE a = (SELECT a FROM (SELECT MIN(a) AS a FROM sample54) AS x);

### 2. 스칼라 값
